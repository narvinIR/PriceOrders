"""
Pytest fixtures для тестов PriceOrders.
"""
import sys
import pytest
from uuid import UUID

sys.path.insert(0, '/home/dimas/projects/PriceOrders')


# Тестовый client_id
TEST_CLIENT_ID = UUID('00000000-0000-0000-0000-000000000001')


@pytest.fixture
def sample_products():
    """Тестовые товары для unit тестов"""
    return [
        {
            'id': '11111111-1111-1111-1111-111111111111',
            'sku': 'JK-PP-110-2000',
            'name': 'Труба ПП канализационная 110×2000',
            'category': 'Трубы канализационные ПП',
            'brand': 'Jakko',
            'pack_qty': 1
        },
        {
            'id': '22222222-2222-2222-2222-222222222222',
            'sku': 'JK-PP-110-3000',
            'name': 'Труба ПП канализационная 110×3000',
            'category': 'Трубы канализационные ПП',
            'brand': 'Jakko',
            'pack_qty': 1
        },
        {
            'id': '33333333-3333-3333-3333-333333333333',
            'sku': 'JK-PPR-32',
            'name': 'Труба ППР PN20 32×5.4',
            'category': 'Трубы ППР',
            'brand': 'Jakko',
            'pack_qty': 1
        },
        {
            'id': '44444444-4444-4444-4444-444444444444',
            'sku': 'JK-FIT-OTVOD-50-45',
            'name': 'Отвод ППР 50×45°',
            'category': 'Фитинги ППР',
            'brand': 'Jakko',
            'pack_qty': 10
        },
        {
            'id': '55555555-5555-5555-5555-555555555555',
            'sku': 'JK-FIT-MUFTA-32-VR',
            'name': 'Муфта ППР 32 с внутренней резьбой 1"',
            'category': 'Фитинги ППР с резьбой',
            'brand': 'Jakko',
            'pack_qty': 20
        },
        {
            'id': '66666666-6666-6666-6666-666666666666',
            'sku': 'JK-QUIET-110-500',
            'name': 'Jk Prestige Труба малошумная 110×500',
            'category': 'Трубы ПП малошумные',
            'brand': 'Jakko',
            'pack_qty': 1
        },
        {
            'id': '77777777-7777-7777-7777-777777777777',
            'sku': 'JK-NAR-KAN-160-3000',
            'name': 'Труба наружной канализации 160×3000',
            'category': 'Трубы наружной канализации',
            'brand': 'Jakko',
            'pack_qty': 1
        },
    ]


@pytest.fixture
def client_id():
    """Тестовый client_id"""
    return TEST_CLIENT_ID


@pytest.fixture
def pipe_test_cases():
    """Тестовые кейсы для размеров труб"""
    return [
        # (клиентский запрос, ожидаемый размер)
        ('Труба 110×2000', (110, 2000)),
        ('Труба 110x2000', (110, 2000)),
        ('Труба 110*2000', (110, 2000)),
        ('Труба 110-2000', (110, 2000)),
        ('Труба ПП 50×1500', (50, 1500)),
        ('Канализация 32×500', (32, 500)),
        ('Муфта 32', None),  # Не труба - нет размера
        ('Отвод 50×45°', None),  # Угол, не длина
    ]


@pytest.fixture
def normalization_test_cases():
    """Тестовые кейсы для нормализации названий"""
    return [
        # (исходное, ожидаемое после нормализации)
        ('Jk Труба ПП 110×2000', 'труба полипропилен 110 2000'),
        ('Jakko Prestige Труба малошумная', 'труба малошумная'),
        ('Муфта ПП с вн.рез. 32', 'муфта полипропилен с внутренняя резьба 32'),
        ('Отвод 50×45 (уп 20 шт)', 'отвод 50 45'),
        ('Труба ПЭ 32×2000', 'труба полиэтилен 32 2000'),
        ('Колено 90° 50мм', 'отвод 90 50'),
        ('Угольник ППР 32', 'отвод полипропилен 32'),
    ]


@pytest.fixture
def sku_normalization_test_cases():
    """Тестовые кейсы для нормализации SKU"""
    return [
        # (исходное, ожидаемое после нормализации)
        ('JK-PP-110', 'JKPP110'),
        ('jk.pp.110', 'JKPP110'),
        ('JK/PP/110', 'JKPP110'),
        ('  JK PP 110  ', 'JKPP110'),
        ('007890', '7890'),
        ('0', '0'),
    ]
